<div class="overview-page">
  <h1 class="page-title">Visão Geral</h1>

  <!-- KPIs Cards -->
  <div class="kpis-grid">
    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-header">
          <mat-icon class="kpi-icon">attach_money</mat-icon>
          <span class="kpi-label">Custo Total do Dia</span>
        </div>
        <div class="kpi-value">{{ kpis ? formatCurrency(kpis.totalTransportCost) : '...' }}</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-header">
          <mat-icon class="kpi-icon">directions_car</mat-icon>
          <span class="kpi-label">Viagens do Dia</span>
        </div>
        <div class="kpi-value">{{ kpis?.totalTrips || '...' }}</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-header">
          <mat-icon class="kpi-icon">event</mat-icon>
          <span class="kpi-label">Cobertura Média</span>
        </div>
        <div class="kpi-value">{{ kpis?.coverageAvgDays || '...' }} dias</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-header">
          <mat-icon class="kpi-icon">warning</mat-icon>
          <span class="kpi-label">Agências em Risco</span>
        </div>
        <div class="kpi-value">{{ kpis?.agenciesAtRisk || '...' }}</div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Gráficos -->
  <div class="charts-grid">
    <!-- Gráfico de Linha - Custos -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Custo dos Últimos 7 Dias</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas #costChart></canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Gráfico de Rosca - Breakdown de Custos -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Distribuição de Custos</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas #costBreakdownChart></canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Gráfico de Barra - Cobertura -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Top 5 Agências - Cobertura</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas #coverageChart></canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Gráfico de Pizza - Risco -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Distribuição de Risco</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas #riskChart></canvas>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Agências Mais Críticas -->
  <mat-card class="critical-card">
    <mat-card-header>
      <mat-card-title>Agências Mais Críticas</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <table mat-table [dataSource]="criticalAgencies" class="critical-table">
        <ng-container matColumnDef="agency">
          <th mat-header-cell *matHeaderCellDef>Agência</th>
          <td mat-cell *matCellDef="let agency">{{ agency.agency }}</td>
        </ng-container>

        <ng-container matColumnDef="daysCovered">
          <th mat-header-cell *matHeaderCellDef>Dias Cobertos</th>
          <td mat-cell *matCellDef="let agency">{{ agency.daysCovered }}</td>
        </ng-container>

        <ng-container matColumnDef="level">
          <th mat-header-cell *matHeaderCellDef>Nível</th>
          <td mat-cell *matCellDef="let agency">
            <span [class]="getLevelClass(agency.level)">
              {{ getLevelLabel(agency.level) }}
            </span>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </mat-card-content>
  </mat-card>
</div>

